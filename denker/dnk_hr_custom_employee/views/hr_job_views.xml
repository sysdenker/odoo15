<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="dnk_custom_employee_hr_job_inherit_form_view" model="ir.ui.view">
        <field name="name">dnk.custom.employee.hr.job.inherit.form.view</field>
        <field name="model">hr.job</field>
        <field name="inherit_id" ref="hr.view_hr_job_form"/>
        <field name="arch" type="xml">
            <field name="description" position="after">
                <field name="employee_register_ids"/>
                <field name="employee_deregister_ids"/>
            </field>

            <field name="user_id" position="after">
                <field name="dnk_plantilla_autorizada"/>
            </field>

            <field name="no_of_recruitment" position="after">
                <field name="dnk_vacantes_abiertas"/>
            </field>
        </field>
    </record>

    <record id="dnk_custom_employee_hr_job_inherit_tree_view" model="ir.ui.view">
        <field name="name">dnk.custom.employee.hr.job.inherit.tree.view</field>
        <field name="model">hr.job</field>
        <field name="inherit_id" ref="hr.view_hr_job_tree"/>
        <field name="arch" type="xml">
            <field name="name" position="before">
                <field name="sequence" widget="handle"/>
            </field>

            <field name="department_id" position="after">
                 <field name="dnk_plantilla_autorizada"/>
            </field>

            <field name="no_of_recruitment" position="after">
                 <field name="dnk_vacantes_abiertas"/>
            </field>
        </field>
    </record>

    <record id="dnk_custom_employee_hr_job_inherit_search_view" model="ir.ui.view">
        <field name="name">dnk.custom.employee.hr.job.inherit.search.view</field>
        <field name="model">hr.job</field>
        <field name="inherit_id" ref="hr.view_job_filter"/>
        <field name="arch" type="xml">
            <filter name="in_recruitment" position="after">
                <filter domain="[('dnk_vacantes_abiertas','>','0')]" string="Con Vacantes Abiertas" name="with_open_vacancy"/>
            </filter>
        </field>
     </record>

    <record id="dnk_custom_employee_hr_job_inherit_kanban_view" model="ir.ui.view">
        <field name="name">dnk.custom.employee.hr.job.inherit.kanban.view</field>
        <field name="model">hr.job</field>
        <field name="inherit_id" ref="hr_recruitment.view_hr_job_kanban"/>
        <field name="arch" type="xml">
            <field name="user_id" position="after">
                <field name="dnk_plantilla_autorizada"/>
                <field name="no_of_recruitment"/>
            </field>
            <!--
            <xpath expr="//kanban/templates/t/div/div[1]/div[1]/div[1]" position="after">
                <div><t t-esc="record.department_id.value"/></div>
            </xpath>-->

            <xpath expr="//kanban/templates/t/div/div[2]" position="inside">
                <div class="row">
                    <div class="col-xs-6 o_kanban_primary_left">
                        <small>Plantilla Autorizada: <i class="fa fa-pencil-square-o"/> <field name="dnk_plantilla_autorizada"/> </small>
                    </div>
                    <div class="col-xs-6 o_kanban_primary_right">
                        <small>Empleados Actuales: <i class="fa fa-users"/> <field name="no_of_recruitment"/> </small>
                    </div>
                </div>
            </xpath>
        </field>
    </record>

    <!-- server actions to add option in the menu "More" -->
    <record id="action_update_open_vacancy" model="ir.actions.server">
        <field name="name">Update Open Vacancy</field>
        <field name="model_id" ref="hr.model_hr_job"/>
        <field name="state">code</field>
        <field name="code">
        records._compute_vacantes_abiertas()
        </field>
    </record>
</odoo>
