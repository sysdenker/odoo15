<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="dnk_mrp_production_custom_form" model="ir.ui.view">
        <field name="name">dnk.mrp.production.custom.form</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
        <field name="arch" type="xml">
            <xpath expr="//form[1]/sheet[1]/group[1]/group[1]/field[@name='product_id']" position="after">
                <field name="dnk_product_default_code"/>
                <field name="dnk_attribute_color_name"/>
                <field name="dnk_attribute_color" widget="color"/>
                <!--<field name="dnk_attribute_color_name" attrs="{'invisible': [('dnk_attribute_color', '=', '#313131')]}"/>
                <field name="dnk_attribute_color" widget="color" attrs="{'invisible': [('dnk_attribute_color', '=', '#313131')]}"/>-->
            </xpath>
            <field name="company_id" position="after">
                <field name="dnk_workorder_ready"/>
                <field name="dnk_workorder_ready_state"/>
            </field>
        </field>
    </record>

    <record id="dnk_mrp_production_custom_tree" model="ir.ui.view">
        <field name="name">dnk.mrp.production.custom.tree</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="mrp.mrp_production_tree_view"/>
        <field name="arch" type="xml">
            <field name="state" position="after">
                <field name="dnk_workorder_ready"/>
                <field name="dnk_workorder_ready_state"/>
            </field>
        </field>
    </record>

    <record id="dnk_mrp_production_line_custom_kanban" model="ir.ui.view">
        <field name="name">dnk.mrp.production.line.custom.kanban</field>
        <field name="model">mrp.production</field>
        <field name="inherit_id" ref="mrp.mrp_production_kanban_view"/>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile" position="replace">
                <kanban class="o_kanban_mobile">
                    <field name="name"/>
                    <field name="product_id"/>
                    <field name="product_qty"/>
                    <field name="product_uom_id" options="{'no_open':True,'no_create':True}"/>
                    <field name="date_deadline"/>
                    <field name="state"/>
                    <field name="activity_state"/>
                    <field name="origin"/>
                    <field name="dnk_product_default_code"/>
                    <field name="dnk_attribute_color"/>
                    <field name="dnk_attribute_inverse_color"/>
                    <field name="dnk_attribute_color_name"/>
                    <field name="dnk_workorder_ready"/>
                    <field name="dnk_workorder_ready_state"/>
                    <progressbar field="activity_state" colors='{"planned": "success", "today": "warning", "overdue": "danger"}'/>
                    <templates>
                        <t t-name="kanban-box">
                            <t t-if="record.dnk_attribute_color_name.value != ''">
                                <t t-set="font_background_color" t-value="'background-color:'+record.dnk_attribute_color.value+';color:'+record.dnk_attribute_inverse_color.value+';'"/>
                            </t>
                            <t t-else="">
                                <t t-set="font_background_color" t-value="''"/>
                            </t>
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click oe_kanban_color_{record.dnk_attribute_color.value}" t-attf-style="{{font_background_color}}">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings mt4">
                                        <strong class="o_kanban_record_title"><span t-attf-style="{{font_background_color}}">[<t t-esc="record.dnk_product_default_code.value"/>]</span></strong>
                                    </div>
                                    <span class="float-right text-right"><t t-esc="record.product_qty.value"/> <small><t t-esc="record.product_uom_id.value"/></small></span>
                                </div>
                                <div class="o_kanban_record_top">
                                    <div class="oe_kanban_bottom_left text-muted">
                                        <strong class="o_kanban_record_title"><span t-attf-style="{{font_background_color}}">[<t t-esc="record.date_deadline.value"/>]</span></strong>
                                    </div>
                                    <span class="oe_kanban_bottom_right">
                                        <t t-esc="record.product_qty.value"/> <small><t t-esc="record.origin.value"/></small>
                                    </span>
                                </div>
                                <div class="o_kanban_record_bottom">
                                    <div class="oe_kanban_bottom_left text-muted">
                                        <span t-attf-style="{{font_background_color}}"><t t-esc="record.name.value"/> <t t-esc="record.date_deadline.value and record.date_deadline.value.split(' ')[0] or False"/></span>
                                        <field name="activity_ids" widget="kanban_activity"/>
                                    </div>
                                    <div class="oe_kanban_bottom_right">
                                        <span t-attf-class="badge #{['draft', 'cancel'].indexOf(record.state.raw_value) > -1 ? 'badge-secondary' : ['none'].indexOf(record.state.raw_value) > -1 ? 'badge-danger' : ['confirmed'].indexOf(record.state.raw_value) > -1 ? 'badge-warning' : ['done'].indexOf(record.state.raw_value) > -1 ? 'badge-success' : 'badge-primary'}"><t t-esc="record.state.value"/></span>
                                    </div>
                                </div>
                                <div class="o_kanban_record_bottom">
                                    <div class="oe_kanban_bottom_left text-muted">
                                        <t t-if="record.dnk_workorder_ready.value"><br/><t t-esc="record.dnk_workorder_ready.value"/><span t-attf-class="badge #{['ready'].indexOf(record.dnk_workorder_ready_state.raw_value) &gt; -1 ? 'badge-danger' : ['progress'].indexOf(record.dnk_workorder_ready_state.raw_value) &gt; -1 ? 'badge-success' : 'badge-primary'}"><t t-esc="record.dnk_workorder_ready_state.value"/></span></t>
                                    </div>
                                    <div class="oe_kanban_bottom_right">
                                        <t t-if="record.dnk_attribute_color_name.value"><br/><span class="pull-left text-left"><field name="dnk_attribute_color_name"/></span></t>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
                <!-- <kanban class="o_kanban_mobile">
                    <field name="name"/>
                    <field name="product_id"/>
                    <field name="product_qty"/>
                    <field name="product_uom_id" options="{'no_open':True,'no_create':True}"/>
                    <field name="date_planned_start"/>
                    <field name="state"/>
                    <field name="dnk_product_default_code"/>
                    <field name="dnk_attribute_color"/>
                    <field name="dnk_attribute_inverse_color"/>
                    <field name="dnk_attribute_color_name"/>
                    <field name="dnk_workorder_ready"/>
                    <field name="dnk_workorder_ready_state"/>
                    <templates>
                        <t t-name="kanban-box">
                            <t t-if="record.dnk_attribute_color_name.value != ''">
                                <t t-set="font_background_color" t-value="'background-color:'+record.dnk_attribute_color.value+';color:'+record.dnk_attribute_inverse_color.value+';'"/>
                            </t>
                            <t t-else="">
                                <t t-set="font_background_color" t-value="''"/>
                            </t>
                            <div t-attf-class="oe_kanban_card oe_kanban_global_click oe_kanban_color_{record.dnk_attribute_color.value}" t-attf-style="{{font_background_color}}">
                                <div class="o_kanban_record_top">
                                    <div class="o_kanban_record_headings mt4">
                                        <strong class="o_kanban_record_title">
                                        <span t-attf-style="{{font_background_color}}">
                                            <t t-esc="record.name.value"/><br/>
                                        </span>
                                        </strong>
                                        <span>[<t t-esc="record.dnk_product_default_code.value"/>]
                                        </span>
                                        <t t-if="record.dnk_workorder_ready.value"><br/><t t-esc="record.dnk_workorder_ready.value"/><span t-attf-class="label #{['ready'].indexOf(record.dnk_workorder_ready_state.raw_value) &gt; -1 ? 'label-danger' : ['progress'].indexOf(record.dnk_workorder_ready_state.raw_value) &gt; -1 ? 'label-success' : 'label-primary'}"><t t-esc="record.dnk_workorder_ready_state.value"/></span></t>
                                    </div>
                                    <span class="pull-right text-right">
                                      <t t-esc="record.product_qty.value"/> <small>
                                      <t t-esc="record.product_uom_id.value"/></small><br/>
                                      <span><t t-esc="record.date_planned_start.value and record.date_planned_start.value.split(' ')[0] or False"/></span><br/><span t-attf-class="label #{['draft', 'cancel'].indexOf(record.state.raw_value) &gt; -1 ? 'label-default' : ['none'].indexOf(record.state.raw_value) &gt; -1 ? 'label-danger' : ['confirmed'].indexOf(record.state.raw_value) &gt; -1 ? 'label-warning' : ['done'].indexOf(record.state.raw_value) &gt; -1 ? 'label-success' : 'label-primary'}"><t t-esc="record.state.value"/></span>
                                      <t t-if="record.dnk_attribute_color_name.value"><br/><span class="pull-left text-left"><field name="dnk_attribute_color_name"/></span></t>
                                    </span>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>-->
            </kanban>
        </field>
    </record>
</odoo>
